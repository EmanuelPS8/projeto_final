<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Projeto de exemplo" />
    <meta name="author" content="Emanuel Pereira Schlickmann" />
    <meta name="robots" content="index, follow" />
    <title>Projeto</title>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="icon" href="img/..." type="image/x-icon" />
  </head>
  <body>
    <header>
      <h1 class="logo"><a href="index.html">Logo</a></h1>
      <nav class="nav">
        <ul>
          <li><a href="html/sobre.html">Sobre</a></li>
          <li><a href="html/noticias.html">Notícias</a></li>
          <li><a href="html/colunas.html">Colunas</a></li>
          <li><a href="html/galeria.html">Galeria</a></li>
          <li><a href="html/agenda.html">Agenda</a></li>
        </ul>
      </nav>
      <div class="busca">
        <input
          type="text"
          placeholder="Buscar"
          title="Digite os termos que você deseja procurar."
          aria-label="Buscar"
        />
      </div>
    </header>

    <main class="conteudo">
      <div class="principal">
        <!-- Slider -->
        <div class="slider">
          <img id="moldura" class="fadeIn" src="" />
          <button id="btnVoltar" class="botao botao-esquerda">&lt;</button>
          <button id="btnAvancar" class="botao botao-direita">&gt;</button>
        </div>

        <!-- Sobre -->
        <section>
          <article>
            <div class="sobre">
              <h2 class="sobre-h2">Sobre</h2>
              <p>
                Este é um projeto de exemplo para demonstrar o uso de HTML, CSS
                e JavaScript. O objetivo é criar uma página web responsiva e
                interativa. Utilizamos boas práticas de desenvolvimento web,
                incluindo acessibilidade e SEO.
              </p>
            </div>
          </article>
        </section>

        <!-- Colunas -->
        <section>
          <article>
            <div class="colunas">
              <h2 class="colunas-h2">
                <a href="html/colunas.html">Colunas</a>
              </h2>
              <div class="colunas-container">
                <div class="coluna-img">
                  <img src="img/col1.jpg" alt="" />
                  <h3>nome pessoa</h3>
                  <p><em>Descrição</em></p>
                </div>
                <div class="coluna-img">
                  <img src="img/col2.jpg" alt="" />
                  <h3>nome pessoa</h3>
                  <p><em>Descrição</em></p>
                </div>
                <div class="coluna-img">
                  <img src="img/col3.jpg" alt="" />
                  <h3>nome pessoa</h3>
                  <p><em>Descrição</em></p>
                </div>
              </div>
            </div>
          </article>
        </section>

        <!-- Agenda -->
        <section>
          <article>
            <div class="agenda" id="agenda-container">
              <h2><a href="html/agenda.html">Agenda</a></h2>
            </div>
          </article>
        </section>

        <!-- Galeria -->
        <section>
          <article>
            <div class="galeria">
              <h2><a href="html/galeria.html">Galeria</a></h2>
              <div class="galeria-imagens">
                <img src="img/img1.jpg" alt="Imagem 1" />
                <img src="img/img2.jpg" alt="Imagem 2" />
                <img src="img/img3.jpg" alt="Imagem 3" />
              </div>
            </div>
          </article>
        </section>
      </div>

      <aside>
        <div class="noticias-aside">
          <h2>Notícias taltal</h2>
          <ul id="noticias-recentes"></ul>
        </div>

        <div class="login-usuario">
          <div class="card-login">
            <h2>Área Restrita</h2>
            <button id="abrirModal"><a href="html/admin.html">Login</a></button>
          </div>
        </div>
      </aside>
    </main>

    <!-- Footer -->
    <footer>
      <div class="footer-container">
        <div class="footer-col">
          <h4>Menu</h4>
          <ul>
            <li><a href="#">Início</a></li>
            <li><a href="html/noticias.html">Notícias</a></li>
            <li><a href="#">Colunas</a></li>
            <li><a href="html/galeria.html">Galeria</a></li>
            <li><a href="html/agenda.html">Agenda</a></li>
          </ul>
        </div>

        <div class="footer-col">
          <h4>Contato</h4>
          <p>Email: email@.com</p>
          <p>Telefone: (00) 0000-0000</p>
        </div>

        <div class="footer-col">
          <h4>Créditos</h4>
          <p>&copy; 2025 - nome nome</p>
          <p>Todos os direitos reservados.</p>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
    <script src="script/script.js"></script>

    <script>
      fetch("http://localhost:5000/api/news")
        .then((response) => response.json())
        .then((newsArray) => {
          const ul = document.getElementById("noticias-recentes");
          const maisRecentes = newsArray
            .sort((a, b) => new Date(b.date) - new Date(a.date))
            .slice(0, 2);
          ul.innerHTML = maisRecentes
            .map(
              (news) =>
                `<li><a href="html/noticias.html">${news.title}</a></li>`
            )
            .join("");
        })
        .catch(() => {
          document.getElementById("noticias-recentes").innerHTML =
            "<li>Erro ao carregar notícias</li>";
        });
    </script>

    <script>
      fetch("http://localhost:5000/api/events")
        .then((response) => response.json())
        .then((eventArray) => {
          const container = document.getElementById("agenda-container");
          const proximosEventos = eventArray
            .filter((e) => new Date(e.date) >= new Date())
            .sort((a, b) => new Date(a.date) - new Date(b.date))
            .slice(0, 3);

          if (proximosEventos.length === 0) {
            container.innerHTML += "<p>Nenhum evento futuro cadastrado.</p>";
            return;
          }

          proximosEventos.forEach((event) => {
            const dataBR = new Date(event.date).toLocaleDateString("pt-BR", {
              day: "2-digit",
              month: "2-digit",
              year: "numeric",
            });

            container.innerHTML += `
            <div class="evento">
              <h3>${event.title}</h3>
              <p>${event.content}</p>
              <p><strong>Data:</strong> ${dataBR}</p>
            </div>
          `;
          });
        })
        .catch(() => {
          document.getElementById("agenda-container").innerHTML +=
            "<p>Erro ao carregar eventos.</p>";
        });
    </script>

    <script>
      const buscaInput = document.querySelector(".busca input");

      buscaInput.addEventListener("input", async (e) => {
        const termo = e.target.value.toLowerCase();

        const noticiasRes = await fetch("http://localhost:5000/api/news");
        const noticias = await noticiasRes.json();
        const noticiasFiltradas = noticias.filter(
          (n) =>
            n.title.toLowerCase().includes(termo) ||
            n.content.toLowerCase().includes(termo)
        );

        const eventosRes = await fetch("http://localhost:5000/api/events");
        const eventos = await eventosRes.json();
        const eventosFiltrados = eventos.filter(
          (e) =>
            e.title.toLowerCase().includes(termo) ||
            e.content.toLowerCase().includes(termo)
        );

        const resultadoHTML = document.createElement("div");
        resultadoHTML.style.background = "#fff";
        resultadoHTML.style.padding = "20px";
        resultadoHTML.style.border = "1px solid #ccc";
        resultadoHTML.style.margin = "20px";

        resultadoHTML.innerHTML = `
        <h2>Resultados da busca:</h2>
        <h3>Notícias:</h3>
        <ul>${noticiasFiltradas.map((n) => `<li>${n.title}</li>`).join("")}</ul>
        <h3>Eventos:</h3>
        <ul>${eventosFiltrados.map((e) => `<li>${e.title}</li>`).join("")}</ul>
      `;

        const existente = document.querySelector("#resultado-busca");
        if (existente) existente.remove();

        resultadoHTML.id = "resultado-busca";
        document.body.appendChild(resultadoHTML);
      });
    </script>
  </body>
</html>
