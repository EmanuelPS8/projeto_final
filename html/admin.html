<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <link rel="stylesheet" href="../css/style_colunas.css">
    <style>
        .admin-container { max-width: 600px; margin: 40px auto; background: #fff; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); padding: 32px; }
        .admin-title { text-align: center; color: #2a2ad1; font-size: 2rem; margin-bottom: 24px; }
        .admin-section { margin-bottom: 32px; }
        .admin-list { margin-top: 16px; }
        .admin-list li { margin-bottom: 8px; }
        .admin-form input, .admin-form textarea { width: 100%; margin-bottom: 10px; padding: 8px; border-radius: 4px; border: 1px solid #ccc; }
        .admin-form button { background: #2a2ad1; color: #fff; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; }
        .admin-form button:hover { background: #2222a1; }
        .logout-btn { float: right; background: #e74c3c; }
    </style>
</head>
<body>
    <div class="admin-container" id="admin-container">
        <div class="admin-title">Admin Login</div>
        <form id="login-form" class="admin-form">
            <input type="text" id="username" placeholder="Username" required>
            <input type="password" id="password" placeholder="Password" required>
            <button type="submit">Login</button>
        </form>
    </div>
    <script>
    const adminContainer = document.getElementById('admin-container');
    const loginForm = document.getElementById('login-form');
    let token = '';

    loginForm.onsubmit = async (e) => {
        e.preventDefault();
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        const res = await fetch('http://localhost:5000/api/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username, password })
        });
        if (res.ok) {
            token = (await res.json()).token;
            loadAdminPanel();
        } else {
            alert('Login failed');
        }
    };

    async function loadAdminPanel() {
        adminContainer.innerHTML = `
            <div class="admin-title">Admin Panel <button class="logout-btn" onclick="location.reload()">Logout</button></div>
            <div class="admin-section">
                <h3>News</h3>
                <form id="news-form" class="admin-form">
                    <input type="text" id="news-title" placeholder="Title" required>
                    <textarea id="news-content" placeholder="Content" required></textarea>
                    <input type="date" id="news-date" required>
                    <button type="submit">Add News</button>
                </form>
                <ul class="admin-list" id="news-list"></ul>
            </div>
            <div class="admin-section">
                <h3>Events</h3>
                <form id="event-form" class="admin-form">
                    <input type="text" id="event-title" placeholder="Title" required>
                    <textarea id="event-content" placeholder="Content" required></textarea>
                    <input type="date" id="event-date" required>
                    <button type="submit">Add Event</button>
                </form>
                <ul class="admin-list" id="event-list"></ul>
            </div>
        `;
        loadNews();
        loadEvents();
        document.getElementById('news-form').onsubmit = addNews;
        document.getElementById('event-form').onsubmit = addEvent;
    }

    async function loadNews() {
        const res = await fetch('http://localhost:5000/api/news', { headers: { 'Authorization': 'Bearer ' + token } });
        const news = await res.json();
        const list = document.getElementById('news-list');
        list.innerHTML = news.map(item => `<li><b>${item.title}</b> (${item.date}) <button onclick="deleteNews(${item.id})">Delete</button></li>`).join('');
    }
    async function loadEvents() {
        const res = await fetch('http://localhost:5000/api/events', { headers: { 'Authorization': 'Bearer ' + token } });
        const events = await res.json();
        const list = document.getElementById('event-list');
        list.innerHTML = events.map(item => `<li><b>${item.title}</b> (${item.date}) <button onclick="deleteEvent(${item.id})">Delete</button></li>`).join('');
    }
    async function addNews(e) {
        e.preventDefault();
        const title = document.getElementById('news-title').value;
        const content = document.getElementById('news-content').value;
        const date = document.getElementById('news-date').value;
        await fetch('http://localhost:5000/api/news', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + token },
            body: JSON.stringify({ title, content, date })
        });
        loadNews();
        e.target.reset();
    }
    async function addEvent(e) {
        e.preventDefault();
        const title = document.getElementById('event-title').value;
        const content = document.getElementById('event-content').value;
        const date = document.getElementById('event-date').value;
        await fetch('http://localhost:5000/api/events', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + token },
            body: JSON.stringify({ title, content, date })
        });
        loadEvents();
        e.target.reset();
    }
    async function deleteNews(id) {
        await fetch(`http://localhost:5000/api/news/${id}`, { method: 'DELETE', headers: { 'Authorization': 'Bearer ' + token } });
        loadNews();
    }
    async function deleteEvent(id) {
        await fetch(`http://localhost:5000/api/events/${id}`, { method: 'DELETE', headers: { 'Authorization': 'Bearer ' + token } });
        loadEvents();
    }
    </script>
</body>
</html> 